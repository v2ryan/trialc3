<!DOCTYPE html>
<html lang="zh-HK">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C3 è®€ç¶“è¨ˆåŠƒ 2026 - éƒ‡å±±å ‚</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft JhengHei", "PingFang TC", "Heiti TC", "Arial Unicode MS", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.8;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: bold;
        }

        header p {
            font-size: 1.1em;
            opacity: 0.95;
        }

        .date-nav {
            background: #f8f9fa;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid #e9ecef;
            flex-wrap: wrap;
            gap: 15px;
        }

        .date-nav button {
            background: #667eea;
            color: white;
            border: none;
            padding: 0 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 48px;
            line-height: 1;
        }

        .date-nav button:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .date-nav button:active {
            transform: translateY(0);
        }

        .date-nav button.today {
            background: #28a745;
        }

        .date-nav button.today:hover {
            background: #218838;
        }

        .current-date {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            flex: 1;
            text-align: center;
            min-width: 200px;
        }

        .content {
            padding: 40px 30px;
        }

        .scripture-section {
            margin-bottom: 40px;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .scripture-title {
            font-size: 1.8em;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 3px solid #667eea;
            font-weight: bold;
        }

        /* ç¶“æ–‡å·¥å…·æŒ‰éˆ•ï¼šçµ±ä¸€å¤–è§€ï¼ˆè½‰æ–°è­¯æœ¬ / è­¯æœ¬å°ç…§ / ç¶“æ–‡æ³¨é‡‹ï¼‰ */
        .btn-scripture {
            display: inline-block;
            font-size: 1rem;
            line-height: 1.6;
            padding: 4px 10px;
            border-radius: 6px;
            border: 1px solid #cfd9ff;
            background: #f5f8ff;
            color: #3f6ad8;
            text-decoration: none;
            white-space: nowrap;
            cursor: pointer;
            transition: background 0.2s ease, border-color 0.2s ease;
            vertical-align: middle;
            font-weight: normal;
        }

        .btn-scripture:hover {
            background: #eaf0ff;
            border-color: #b7c5ff;
        }

        /* ä½ç½®å¾®èª¿ */
        .scripture-title .btn-scripture {
            margin-left: 10px;
        }

        .scripture-tools {
            margin-bottom: 15px;
            margin-top: -5px;
        }

        .scripture-tools .btn-scripture {
            margin-right: 10px;
            margin-top: 6px;
        }

        .scripture-text {
            line-height: 2.2;
            font-size: 1.15em;
            color: #2c3e50;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 5px solid #667eea;
        }

        .verse {
            display: grid;
            grid-template-columns: 36px 1fr;
            /* å·¦ï¼šç¯€è™Ÿå¯¬åº¦ */
            column-gap: 12px;
            align-items: start;
            margin-bottom: 14px;
        }

        .verse-number {
            display: block;
            text-align: right;
            font-variant-numeric: tabular-nums;
            line-height: 1.6;
            padding-top: 2px;
            color: #667eea;
            font-weight: bold;
            font-size: 0.95em;
        }

        .verse-text {
            display: block;
            line-height: 1.9;
            word-break: break-word;
        }

        /* å°å±å†ç´°å°‘å°‘ */
        @media (max-width: 420px) {
            .verse {
                grid-template-columns: 32px 1fr;
                column-gap: 10px;
            }
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            font-size: 1.3em;
            color: #667eea;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {

            0%,
            20% {
                content: '.';
            }

            40% {
                content: '..';
            }

            60%,
            100% {
                content: '...';
            }
        }

        .rest-day {
            text-align: center;
            padding: 60px 20px;
            font-size: 1.4em;
            color: #6c757d;
            background: #e9ecef;
            border-radius: 12px;
        }

        .error {
            background: #fee;
            color: #c33;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 5px solid #c33;
        }

        .guide {
            background: linear-gradient(135deg, #fff3cd 0%, #ffe8a1 100%);
            padding: 30px;
            border-radius: 12px;
            margin-top: 40px;
            border-left: 5px solid #ffc107;
        }

        .guide h3 {
            color: #856404;
            font-size: 1.5em;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .guide ol {
            margin-left: 25px;
            color: #856404;
        }

        .guide li {
            margin: 12px 0;
            line-height: 1.8;
        }

        .debug {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
        }

        .nav-buttons {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        @media (max-width: 768px) {
            .date-nav {
                flex-direction: column;
            }

            .current-date {
                order: -1;
                margin-bottom: 10px;
            }

            .nav-buttons {
                width: 100%;
                justify-content: space-between;
            }

            .date-nav button {
                flex: 1 1 calc(33.333% - 12px);
                min-width: 0;
                white-space: nowrap;
                padding: 10px 12px;
            }

            header h1 {
                font-size: 1.6em;
            }

            .content {
                padding: 25px 20px;
            }

            .scripture-title {
                font-size: 1.4em;
            }

            .scripture-text {
                font-size: 1.05em;
                padding: 20px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>ğŸ“– C3 è®€ç¶“è¨ˆåŠƒ 2026</h1>
            <p>åŸºç£æ•™æœƒéƒ‡å±±å ‚</p>
        </header>

        <div class="date-nav">
            <div class="current-date" id="currentDate"></div>
            <div class="nav-buttons">
                <button id="prevDay">â† ä¸Šä¸€å¤©</button>
                <button id="todayBtn" class="today">ğŸ“… ä»Šå¤©</button>
                <button id="nextDay">ä¸‹ä¸€å¤© â†’</button>
            </div>
        </div>

        <div class="content">
            <div id="scriptureContainer"></div>

            <div class="guide">
                <h3>ğŸ“ C3 è®€ç¶“ç¨‹åº</h3>
                <ol>
                    <li>åŒè²é Œè®šèˆ‡æ„Ÿæ©ï¼Œå¸¶é ˜äººç°¡æ½”ç¦±å‘ŠçµæŸ</li>
                    <li>æ¯äººæŒ‰æ¬¡åºè¼ªæµè®€ä¸€ç¯€ç¶“æ–‡ï¼Œè®€å®Œä¸€é½Šè¬›ã€Œé˜¿å€‘ã€</li>
                    <li>æ¯äººè¼ªæµç¦±è®€å…©ç¯€ç¶“æ–‡ï¼Œè¢«è§¸å‹•æ™‚å¯å¤§è²é‡è¤‡è®€æˆ–ç¥ˆç¦±</li>
                    <li>åˆ†äº«ä¸‰é …ï¼š(1) ç¥çš„å±¬æ€§ (2) ç¶“æ–‡çš„æ•™è¨“ (3) ç”¨æ„Ÿæ©ç¦±å‘Šè¡¨é”è§¸å‹•</li>
                    <li>ä¸»é ˜é¸ä¸€é …æˆç‚ºç•¶å¤©å¯¦è¸çš„å…§å®¹æˆ–é‡‘å¥é»˜æƒ³</li>
                    <li>é½Šè²ç™¼å‡ºæ„Ÿæ©ç¦±å‘Šï¼Œå¸¶é ˜äººç‚ºå„äººæåç¥ç¦</li>
                </ol>
                <p style="margin-top: 15px; font-style: italic;">* é€¢æ˜ŸæœŸäº”ã€å…­ã€æ—¥åŠå…¬çœ¾å‡æ—¥æš«åœ</p>
            </div>

            <div id="debugInfo" class="debug" style="display: none;"></div>
        </div>
    </div>

    <script>
        // C3 è®€ç¶“è¨ˆåŠƒå®Œæ•´æ•¸æ“š
        const READING_PLAN = {
            '2026-01-01': null, '2026-01-02': null,
            '2026-01-05': 'ç®´15:11-19', '2026-01-06': 'ç®´15:20-33', '2026-01-07': 'ç®´16:1-9', '2026-01-08': 'ç®´16:10-16', '2026-01-09': null,
            '2026-01-12': 'ç®´16:17-24', '2026-01-13': 'ç®´16:25-33', '2026-01-14': 'ç®´17:1-10', '2026-01-15': 'ç®´17:11-18', '2026-01-16': null,
            '2026-01-19': 'ç®´17:19-28', '2026-01-20': 'ç®´18:1-11', '2026-01-21': 'ç®´18:12-24', '2026-01-22': 'ç®´19:1-9', '2026-01-23': null,
            '2026-01-26': 'ç®´19:10-17', '2026-01-27': 'ç®´19:18-29', '2026-01-28': 'ç®´20:1-10', '2026-01-29': 'ç®´20:11-19', '2026-01-30': null,
            '2026-02-02': 'ç®´20:20-30', '2026-02-03': 'ç®´21:1-10', '2026-02-04': 'ç®´21:11-21', '2026-02-05': 'ç®´21:22-31', '2026-02-06': null,
            '2026-02-09': 'ç®´22:1-9', '2026-02-10': 'ç®´22:10-21', '2026-02-11': 'ç®´22:22-29', '2026-02-12': 'ç®´23:1-11', '2026-02-13': null,
            '2026-02-16': null, '2026-02-17': null, '2026-02-18': null, '2026-02-19': null, '2026-02-20': null,
            '2026-02-23': 'ç®´23:12-22', '2026-02-24': 'ç®´23:23-35', '2026-02-25': 'ç®´24:1-12', '2026-02-26': 'ç®´24:13-23', '2026-02-27': null,
            '2026-03-02': 'ç®´24:23-34', '2026-03-03': 'ç®´25:1-10', '2026-03-04': 'ç®´25:11-19', '2026-03-05': 'ç®´25:20-28', '2026-03-06': null,
            '2026-03-09': 'ç®´26:1-9', '2026-03-10': 'ç®´26:10-19', '2026-03-11': 'ç®´26:20-28', '2026-03-12': 'ç®´27:1-9', '2026-03-13': null,
            '2026-03-16': 'ç®´27:10-17', '2026-03-17': 'ç®´27:18-27', '2026-03-18': 'ç®´28:1-9', '2026-03-19': 'ç®´28:10-18', '2026-03-20': null,
            '2026-03-23': 'ç®´28:19-28', '2026-03-24': 'ç®´29:1-9', '2026-03-25': 'ç®´29:10-18', '2026-03-26': 'ç®´29:19-27', '2026-03-27': null,
            '2026-03-30': 'ç®´30:1-9', '2026-03-31': 'ç®´30:10-20',
            '2026-04-01': 'ç®´30:21-33', '2026-04-02': 'ç®´31:1-9', '2026-04-03': null, '2026-04-06': null, '2026-04-07': null,
            '2026-04-08': 'ç®´31:10-31', '2026-04-09': 'ç´„ä¸€1:1-10', '2026-04-10': null,
            '2026-04-13': 'ç´„ä¸€2:1-6', '2026-04-14': 'ç´„ä¸€2:7-13', '2026-04-15': 'ç´„ä¸€2:14-17', '2026-04-16': 'ç´„ä¸€2:18-23', '2026-04-17': null,
            '2026-04-20': 'ç´„ä¸€2:24-29', '2026-04-21': 'ç´„ä¸€3:1-6', '2026-04-22': 'ç´„ä¸€3:7-12', '2026-04-23': 'ç´„ä¸€3:13-20', '2026-04-24': null,
            '2026-04-27': 'ç´„ä¸€3:21-24', '2026-04-28': 'ç´„ä¸€4:1-6', '2026-04-29': 'ç´„ä¸€4:7-13', '2026-04-30': 'ç´„ä¸€4:14-21',
            '2026-05-01': null, '2026-05-04': 'ç´„ä¸€5:1-12', '2026-05-05': 'ç´„ä¸€5:13-17', '2026-05-06': 'ç´„ä¸€5:18-21', '2026-05-07': 'ç´„äºŒ1-8', '2026-05-08': null,
            '2026-05-11': 'ç´„äºŒ9-13', '2026-05-12': 'ç´„ä¸‰1-10', '2026-05-13': 'ç´„ä¸‰11-15', '2026-05-14': 'ç´„1:1-18', '2026-05-15': null,
            '2026-05-18': 'ç´„1:19-34', '2026-05-19': 'ç´„1:35-51', '2026-05-20': 'ç´„2:1-12', '2026-05-21': 'ç´„2:13-25', '2026-05-22': null,
            '2026-05-25': 'ç´„3:1-15', '2026-05-26': 'ç´„3:16-36', '2026-05-27': 'ç´„4:1-26', '2026-05-28': 'ç´„4:27-42', '2026-05-29': null,
            '2026-06-01': 'ç´„4:43-54', '2026-06-02': 'ç´„5:1-15', '2026-06-03': 'ç´„5:16-30', '2026-06-04': 'ç´„5:31-47', '2026-06-05': null,
            '2026-06-08': 'ç´„6:1-15', '2026-06-09': 'ç´„6:16-21', '2026-06-10': 'ç´„6:22-40', '2026-06-11': 'ç´„6:41-59', '2026-06-12': null,
            '2026-06-15': 'ç´„6:60-71', '2026-06-16': 'ç´„7:1-13', '2026-06-17': 'ç´„7:14-24', '2026-06-18': 'ç´„7:25-36', '2026-06-19': null,
            '2026-06-22': 'ç´„7:37-52', '2026-06-23': 'ç´„8:1-11', '2026-06-24': 'ç´„8:12-20', '2026-06-25': 'ç´„8:21-30', '2026-06-26': null,
            '2026-06-29': 'ç´„8:31-47', '2026-06-30': 'ç´„8:48-59',
            '2026-07-01': null, '2026-07-02': 'ç´„9:1-12', '2026-07-03': null,
            '2026-07-06': 'ç´„9:13-34', '2026-07-07': 'ç´„9:35-41', '2026-07-08': 'ç´„10:1-10', '2026-07-09': 'ç´„10:11-21', '2026-07-10': null,
            '2026-07-13': 'ç´„10:22-29', '2026-07-14': 'ç´„10:30-42', '2026-07-15': 'ç´„11:1-16', '2026-07-16': 'ç´„11:17-27', '2026-07-17': null,
            '2026-07-20': 'ç´„11:28-37', '2026-07-21': 'ç´„11:38-44', '2026-07-22': 'ç´„11:45-57', '2026-07-23': 'ç´„12:1-11', '2026-07-24': null,
            '2026-07-27': 'ç´„12:12-19', '2026-07-28': 'ç´„12:20-26', '2026-07-29': 'ç´„12:27-36', '2026-07-30': 'ç´„12:37-50', '2026-07-31': null,
            '2026-08-03': 'ç´„13:1-17', '2026-08-04': 'ç´„13:18-30', '2026-08-05': 'ç´„13:31-38', '2026-08-06': 'ç´„14:1-14', '2026-08-07': null,
            '2026-08-10': 'ç´„14:15-31', '2026-08-11': 'ç´„15:1-17', '2026-08-12': 'ç´„15:18-27', '2026-08-13': 'ç´„16:1-11', '2026-08-14': null,
            '2026-08-17': 'ç´„16:12-22', '2026-08-18': 'ç´„16:23-33', '2026-08-19': 'ç´„17:1-12', '2026-08-20': 'ç´„17:13-26', '2026-08-21': null,
            '2026-08-24': 'ç´„18:1-11', '2026-08-25': 'ç´„18:12-24', '2026-08-26': 'ç´„18:25-32', '2026-08-27': 'ç´„18:33-40', '2026-08-28': null,
            '2026-08-31': 'ç´„19:1-16',
            '2026-09-01': 'ç´„19:17-27', '2026-09-02': 'ç´„19:28-42', '2026-09-03': 'ç´„20:1-10', '2026-09-04': null,
            '2026-09-07': 'ç´„20:11-18', '2026-09-08': 'ç´„20:19-31', '2026-09-09': 'ç´„21:1-14', '2026-09-10': 'ç´„21:15-25', '2026-09-11': null,
            '2026-09-14': 'ç¾…1:1-7', '2026-09-15': 'ç¾…1:8-15', '2026-09-16': 'ç¾…1:16-25', '2026-09-17': 'ç¾…1:26-32', '2026-09-18': null,
            '2026-09-21': 'ç¾…2:1-11', '2026-09-22': 'ç¾…2:12-16', '2026-09-23': 'ç¾…2:17-29', '2026-09-24': 'ç¾…3:1-8', '2026-09-25': null,
            '2026-09-28': 'ç¾…3:9-20', '2026-09-29': 'ç¾…3:21-31', '2026-09-30': 'ç¾…4:1-8',
            '2026-10-01': null, '2026-10-02': null,
            '2026-10-05': 'ç¾…4:9-16', '2026-10-06': 'ç¾…4:17-25', '2026-10-07': 'ç¾…5:1-11', '2026-10-08': 'ç¾…5:12-21', '2026-10-09': null,
            '2026-10-12': 'ç¾…6:1-11', '2026-10-13': 'ç¾…6:12-23', '2026-10-14': 'ç¾…7:1-6', '2026-10-15': 'ç¾…7:7-17', '2026-10-16': null,
            '2026-10-19': 'ç¾…7:18-25', '2026-10-20': 'ç¾…8:1-11', '2026-10-21': 'ç¾…8:12-25', '2026-10-22': 'ç¾…8:26-30', '2026-10-23': null,
            '2026-10-26': 'ç¾…8:31-39', '2026-10-27': 'ç¾…9:1-13', '2026-10-28': 'ç¾…9:14-20', '2026-10-29': 'ç¾…9:21-29', '2026-10-30': null,
            '2026-11-02': 'ç¾…9:30-10:4', '2026-11-03': 'ç¾…10:5-13', '2026-11-04': 'ç¾…10:14-21', '2026-11-05': 'ç¾…11:1-10', '2026-11-06': null,
            '2026-11-09': 'ç¾…11:11-16', '2026-11-10': 'ç¾…11:17-24', '2026-11-11': 'ç¾…11:25-32', '2026-11-12': 'ç¾…11:33-12:2', '2026-11-13': null,
            '2026-11-16': 'ç¾…12:3-8', '2026-11-17': 'ç¾…12:9-21', '2026-11-18': 'ç¾…13:1-7', '2026-11-19': 'ç¾…13:8-14', '2026-11-20': null,
            '2026-11-23': 'ç¾…14:1-6', '2026-11-24': 'ç¾…14:7-12', '2026-11-25': 'ç¾…14:13-23', '2026-11-26': 'ç¾…15:1-13', '2026-11-27': null,
            '2026-11-30': 'ç¾…15:14-21',
            '2026-12-01': 'ç¾…15:22-29', '2026-12-02': 'ç¾…15:30-16:2', '2026-12-03': 'ç¾…16:3-16', '2026-12-04': null,
            '2026-12-07': 'ç¾…16:17-27', '2026-12-08': 'åŠ 1:1-10', '2026-12-09': 'åŠ 1:11-17', '2026-12-10': 'åŠ 1:18-24', '2026-12-11': null,
            '2026-12-14': 'åŠ 2:1-10', '2026-12-15': 'åŠ 2:11-16', '2026-12-16': 'åŠ 2:17-21', '2026-12-17': 'åŠ 3:1-9', '2026-12-18': null,
            '2026-12-21': 'åŠ 3:10-14', '2026-12-22': 'åŠ 3:15-22', '2026-12-23': 'åŠ 3:23-29', '2026-12-24': null, '2026-12-25': null,
            '2026-12-28': 'åŠ 4:1-11', '2026-12-29': 'åŠ 4:12-20', '2026-12-30': 'åŠ 4:21-31', '2026-12-31': 'åŠ 5:1-6'
        };

        // æ›¸å·åç¨±å°ç…§ (ç”¨æ–¼ API)
        // æ³¨æ„ï¼šAPI ä½¿ç”¨ "ç´„ä¸€"ã€"ç´„äºŒ"ã€"ç´„ä¸‰"ï¼Œä¸æ˜¯ "ç´„å£¹"ã€"ç´„è²³"ã€"ç´„åƒ"
        const BOOK_MAP = {
            'ç®´': 'ç®´',
            'ç´„ä¸€': 'ç´„ä¸€',
            'ç´„äºŒ': 'ç´„äºŒ',
            'ç´„ä¸‰': 'ç´„ä¸‰',
            'ç´„': 'ç´„',
            'ç¾…': 'ç¾…',
            'åŠ ': 'åŠ '
        };

        // æ›¸å·åç¨±å°ç…§ (ç”¨æ–¼ cnbible.com)
        const CNBIBLE_BOOK_MAP = {
            'ç®´': 'proverbs',
            'ç´„ä¸€': '1_john',
            'ç´„äºŒ': '2_john',
            'ç´„ä¸‰': '3_john',
            'ç´„': 'john',
            'ç¾…': 'romans',
            'åŠ ': 'galatians'
        };

        let currentDate = new Date();
        const debugMode = window.location.hash === '#debug';

        function log(msg, data) {
            if (debugMode) {
                const debugDiv = document.getElementById('debugInfo');
                debugDiv.style.display = 'block';
                const entry = document.createElement('div');
                entry.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
                if (data) entry.textContent += ': ' + JSON.stringify(data);
                debugDiv.appendChild(entry);
                console.log(msg, data);
            }
        }

        function formatDate(date) {
            const y = date.getFullYear();
            const m = String(date.getMonth() + 1).padStart(2, '0');
            const d = String(date.getDate()).padStart(2, '0');
            return `${y}-${m}-${d}`;
        }

        function formatDisplayDate(date) {
            const weekdays = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
            const y = date.getFullYear();
            const m = date.getMonth() + 1;
            const d = date.getDate();
            const wd = weekdays[date.getDay()];
            return `${y}å¹´${m}æœˆ${d}æ—¥ æ˜ŸæœŸ${wd}`;
        }

        function parseReference(ref) {
            // è§£æç¶“æ–‡å¼•ç”¨ï¼Œä¾‹å¦‚ "ç´„1:1-18"
            const match = ref.match(/^([^0-9]+)(\d+):(\d+)(?:-(\d+))?$/);
            if (!match) {
                log('Parse failed', ref);
                return null;
            }

            const [, rawBook, chapter, startVerse, endVerse] = match;
            const book = BOOK_MAP[rawBook] || rawBook;

            const result = {
                book,
                chapter: parseInt(chapter),
                startVerse: parseInt(startVerse),
                endVerse: endVerse ? parseInt(endVerse) : parseInt(startVerse)
            };

            log('Parsed reference', result);
            return result;
        }

        function getCnbibleChapterUrl(ref) {
            // é‡ç”¨ parseReference ä¾†è§£æç¶“æ–‡å¼•ç”¨
            const parsed = parseReference(ref);
            if (!parsed) return null;

            // å¾ map ç²å–æ›¸å·çš„è‹±æ–‡ slug
            const englishBook = CNBIBLE_BOOK_MAP[parsed.book];
            if (!englishBook) return null;

            // ç”Ÿæˆ cnbible.com ç« ç¯€ URL
            return `https://cnbible.com/cnvt/${englishBook}/${parsed.chapter}.htm`;
        }

        // ====== CCBibleStudy helpers ======
        const CCB_BASE = 'https://www.ccbiblestudy.org';
        const encodePath = (s) => s.replace(/ /g, '%20');

        function pad2(n) { return String(n).padStart(2, '0'); }
        function pad3(n) { return String(n).padStart(3, '0'); }

        /**
         * CCBibleStudy è¨»è§£ï¼ˆCTï¼‰é€£çµ
         */
        function getCcbiblestudyCommentaryUrl(ref) {
            const p = parseReference(ref);
            if (!p || !p.book || !p.chapter) return null;

            if (p.book === 'è©©') {
                return `${CCB_BASE}/Old%20Testament/19Psa/19CT${pad3(p.chapter)}.htm`;
            }
            if (p.book === 'ç®´') {
                return `${CCB_BASE}/Old%20Testament/20Prov/20CT${p.chapter}.htm`;
            }
            if (p.book === 'ç´„') {
                return `${CCB_BASE}/New%20Testament/43John/43CT${pad2(p.chapter)}.htm`;
            }
            if (p.book === 'ç¾…') {
                return `${CCB_BASE}/New%20Testament/45Rom/45CT${pad2(p.chapter)}.htm`;
            }
            if (p.book === 'ç´„ä¸€' || p.book === 'ç´„äºŒ' || p.book === 'ç´„ä¸‰') {
                return `${CCB_BASE}/New%20Testament/${encodePath('62 1John')}/62CT${pad2(p.chapter)}.htm`;
            }
            return null;
        }

        /**
         * CCBibleStudy è­¯æ–‡å°ç…§ï¼ˆVT PDFï¼‰é€£çµ
         */
        function getCcbiblestudyVtPdfUrl(ref) {
            const p = parseReference(ref);
            if (!p || !p.book || !p.chapter) return null;

            if (p.book === 'è©©') {
                return `${CCB_BASE}/Old%20Testament/19Psa/19VT${pad3(p.chapter)}.pdf`;
            }
            if (p.book === 'ç®´') {
                return `${CCB_BASE}/Old%20Testament/20Prov/20VT${pad2(p.chapter)}.pdf`;
            }
            if (p.book === 'ç´„') {
                return `${CCB_BASE}/New%20Testament/43John/43VT${pad2(p.chapter)}.pdf`;
            }
            if (p.book === 'ç¾…') {
                return `${CCB_BASE}/New%20Testament/45Rom/45VT${pad2(p.chapter)}.pdf`;
            }
            if (p.book === 'ç´„ä¸€' || p.book === 'ç´„äºŒ' || p.book === 'ç´„ä¸‰') {
                return `${CCB_BASE}/New%20Testament/${encodePath('62 1John')}/62VT${pad2(p.chapter)}.pdf`;
            }
            return null;
        }

        async function fetchScriptureFromAPI(ref) {
            const parsed = parseReference(ref);
            if (!parsed) return null;

            // ä½¿ç”¨ qstr æ ¼å¼ - æ¸¬è©¦è­‰æ˜é€™æ˜¯æœ€å¯é çš„æ–¹æ³•
            const qstr = `${parsed.book}${parsed.chapter}:${parsed.startVerse}-${parsed.endVerse}`;
            const url = `https://bible.fhl.net/json/qsb.php?qstr=${encodeURIComponent(qstr)}&version=unv&gb=0`;

            log('Fetching from API', url);

            try {
                const response = await fetch(url);
                const data = await response.json();

                log('API response', data);

                if (data && data.record && Array.isArray(data.record) && data.record.length > 0) {
                    log('Success', `Got ${data.record.length} verses`);
                    return data;
                }

                log('No data in response');
                return null;
            } catch (error) {
                log('Fetch error', error.message);
                return null;
            }
        }

        async function fetchScripture(ref) {
            log('Fetching scripture', ref);

            const data = await fetchScriptureFromAPI(ref);

            if (!data || !data.record || data.record.length === 0) {
                log('Failed to fetch');
                return `<div class="error">âŒ ç„¡æ³•è¼‰å…¥ç¶“æ–‡ï¼š${ref}<br>è«‹æª¢æŸ¥ç¶²çµ¡é€£æ¥æˆ–ç¨å¾Œå†è©¦</div>`;
            }

            // API å·²ç¶“è¿”å›æ­£ç¢ºç¯„åœçš„ç¶“æ–‡ï¼Œç„¡éœ€éæ¿¾
            const verses = data.record;

            // ç”Ÿæˆæ¨™é¡Œå’Œé€£çµ
            const cnbibleURL = getCnbibleChapterUrl(ref);
            const commentaryURL = getCcbiblestudyCommentaryUrl(ref);
            const vtPdfURL = getCcbiblestudyVtPdfUrl(ref);

            // æ¨™é¡Œè¡Œï¼šç¶“æ–‡å¼•ç”¨ + è½‰æ–°è­¯æœ¬
            let titleHTML = ref;
            if (cnbibleURL) {
                titleHTML += ` <a href="${cnbibleURL}" class="btn-scripture">æ–°è­¯æœ¬</a>`;
            }

            // ç¬¬äºŒè¡Œï¼šè­¯æœ¬å°ç…§ / ç¶“æ–‡æ³¨é‡‹
            let linksHTML = '';
            if (vtPdfURL) {
                linksHTML += `<a href="${vtPdfURL}" class="btn-scripture">è­¯æœ¬å°ç…§</a>`;
            }
            if (commentaryURL) {
                linksHTML += `<a href="${commentaryURL}" class="btn-scripture">ç¶“æ–‡è¨»è§£</a>`;
            }

            let html = `<div class="scripture-section">
                <div class="scripture-title">${titleHTML}</div>
                ${linksHTML ? `<div class="scripture-tools">${linksHTML}</div>` : ''}
                <div class="scripture-text">`;

            verses.forEach(v => {
                html += `<div class="verse">
                    <div class="verse-number">${v.sec}</div>
                    <div class="verse-text">${v.bible_text}</div>
                </div>`;
            });

            html += `</div></div>`;

            log('Rendered HTML', `${verses.length} verses`);
            return html;
        }

        async function loadReading(date) {
            const dateStr = formatDate(date);
            const container = document.getElementById('scriptureContainer');
            const displayDate = document.getElementById('currentDate');

            displayDate.textContent = formatDisplayDate(date);

            const reading = READING_PLAN[dateStr];

            if (reading === undefined) {
                container.innerHTML = '<div class="rest-day">ğŸ“… æ­¤æ—¥æœŸä¸åœ¨è®€ç¶“è¨ˆåŠƒç¯„åœå…§</div>';
                return;
            }

            if (reading === null) {
                container.innerHTML = '<div class="rest-day">ğŸ™ ä»Šå¤©æ˜¯ä¼‘æ¯æ—¥æˆ–å…¬çœ¾å‡æœŸ</div>';
                return;
            }

            container.innerHTML = '<div class="loading">è¼‰å…¥ç¶“æ–‡ä¸­</div>';

            const html = await fetchScripture(reading);
            container.innerHTML = html;
        }

        function changeDate(days) {
            currentDate.setDate(currentDate.getDate() + days);
            loadReading(currentDate);
        }

        function goToToday() {
            currentDate = new Date();
            loadReading(currentDate);
        }

        // äº‹ä»¶ç›£è½
        document.getElementById('prevDay').addEventListener('click', () => changeDate(-1));
        document.getElementById('nextDay').addEventListener('click', () => changeDate(1));
        document.getElementById('todayBtn').addEventListener('click', goToToday);

        // éµç›¤å°èˆª
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') changeDate(-1);
            if (e.key === 'ArrowRight') changeDate(1);
            if (e.key === 'Home') goToToday();
        });

        // åˆå§‹åŒ–
        log('App initialized');
        loadReading(currentDate);
    </script>
</body>

</html>